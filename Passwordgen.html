<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generator Password — Custom</title>
  <style>
    :root{ --bg:#0f1724; --card:#0b1220; --accent:#7c3aed; --muted:#9aa4b2; --glass: rgba(255,255,255,0.04); }
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;background:linear-gradient(180deg,#071022 0%, #08122a 60%);color:#e6eef8;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .card{width:720px;max-width:100%;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:22px;box-shadow:0 8px 30px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;align-items:center;gap:16px;margin-bottom:14px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#4f46e5);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px;color:white}
    h1{font-size:18px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 300px;gap:18px}
    @media(max-width:880px){.grid{grid-template-columns:1fr}}

    .panel{background:var(--card);padding:16px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:8px}
    .controls{display:flex;flex-direction:column;gap:12px}

    .row{display:flex;gap:12px;align-items:center}
    input[type=range]{width:100%}
    .num{min-width:60px;padding:8px;border-radius:8px;background:var(--glass);border:1px solid rgba(255,255,255,0.03);color:inherit;text-align:center}

    .checkbox{display:flex;align-items:center;gap:8px}
    .checkbox input{width:18px;height:18px}

    .actions{display:flex;gap:8px;margin-top:12px}
    button{cursor:pointer;padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent),#4f46e5);color:white;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

    .output{display:flex;flex-direction:column;gap:10px}
    .pw-box{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:space-between;gap:10px}
    .pw{font-family:Menlo, monospace;font-size:15px;word-break:break-all;color:#f8fbff}

    .meta{display:flex;align-items:center;gap:10px;justify-content:space-between}
    .strength{padding:6px 10px;border-radius:999px;font-weight:700}
    .strength.weak{background:rgba(220,38,38,0.15);color:#ffb4b4}
    .strength.medium{background:rgba(234,179,8,0.12);color:#ffd88a}
    .strength.strong{background:rgba(34,197,94,0.12);color:#b8ffd3}

    .note{font-size:12px;color:var(--muted)}

    .footer{margin-top:12px;font-size:12px;color:var(--muted);display:flex;justify-content:space-between;align-items:center}

    .copy-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:8px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="card" role="main">
    <header>
      <div class="logo">PW</div>
      <div>
        <h1>Generator Password — Custom</h1>
        <p class="lead">Buat password acak yang kuat. Sesuaikan panjang, tambahkan angka & karakter spesial.</p>
      </div>
    </header>

    <div class="grid">
      <div class="panel">
        <label for="length">Panjang password: <strong id="lenVal">16</strong></label>
        <div class="row">
          <input id="length" type="range" min="4" max="128" value="16" />
          <input id="lengthNum" class="num" type="number" min="4" max="128" value="16" />
        </div>

        <div style="height:8px"></div>

        <div class="controls">
          <label class="checkbox"><input type="checkbox" id="lowercase" checked /> <span>Huruf kecil (a–z)</span></label>
          <label class="checkbox"><input type="checkbox" id="uppercase" checked /> <span>Huruf besar (A–Z)</span></label>
          <label class="checkbox"><input type="checkbox" id="numbers" checked /> <span>Tambahkan angka (0–9)</span></label>
          <label class="checkbox"><input type="checkbox" id="specials" /> <span>Tambahkan karakter spesial (!@#$...)</span></label>
        </div>

        <div class="actions">
          <button id="generate">Generate</button>
          <button id="regen" class="ghost">Regenerate</button>
          <button id="copyAll" class="ghost">Copy</button>
        </div>

        <div class="footer">
          <div class="note">Tip: gunakan kombinasi huruf, angka, dan simbol untuk keamanan terbaik.</div>
          <div class="note">Offline · Satu file</div>
        </div>
      </div>

      <aside class="panel output">
        <label>Hasil</label>
        <div class="pw-box">
          <div class="pw" id="result">—</div>
          <button class="copy-btn" id="copy">Copy</button>
        </div>

        <div class="meta">
          <div>Entropy: <strong id="entropy">0</strong> bits</div>
          <div id="strength" class="strength weak">Weak</div>
        </div>

        <div style="height:8px"></div>
        <label class="note">Preview: password yang dihasilkan akan muncul di atas. Klik Copy untuk menyalin ke clipboard.</label>
      </aside>
    </div>
  </div>

  <script>
    // Character sets
    const LOWER = 'abcdefghijklmnopqrstuvwxyz';
    const UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const NUMS  = '0123456789';
    const SPECS = '!@#$%^&*()_+-=[]{}|;:,.<>/?~`';

    const length = document.getElementById('length');
    const lengthNum = document.getElementById('lengthNum');
    const lenVal = document.getElementById('lenVal');
    const lower = document.getElementById('lowercase');
    const upper = document.getElementById('uppercase');
    const numbers = document.getElementById('numbers');
    const specials = document.getElementById('specials');
    const result = document.getElementById('result');
    const generate = document.getElementById('generate');
    const regen = document.getElementById('regen');
    const copy = document.getElementById('copy');
    const copyAll = document.getElementById('copyAll');
    const entropyEl = document.getElementById('entropy');
    const strengthEl = document.getElementById('strength');

    function syncLength(v){
      length.value = v;
      lengthNum.value = v;
      lenVal.textContent = v;
    }

    length.addEventListener('input', e => syncLength(e.target.value));
    lengthNum.addEventListener('change', e => {
      let v = Number(e.target.value) || 8;
      v = Math.max(4, Math.min(128, v));
      syncLength(v);
    });

    function getCharset(){
      let set = '';
      if(lower.checked) set += LOWER;
      if(upper.checked) set += UPPER;
      if(numbers.checked) set += NUMS;
      if(specials.checked) set += SPECS;
      return set;
    }

    function secureRandomInt(max){
      // return random int in [0, max)
      const array = new Uint32Array(1);
      window.crypto.getRandomValues(array);
      return Math.floor((array[0] / 0xFFFFFFFF) * max);
    }

    function generatePassword(){
      const len = Number(length.value);
      const charset = getCharset();
      if(!charset){
        alert('Pilih set karakter setidaknya satu: lowercase, uppercase, angka, atau spesial.');
        return '';
      }

      // guarantee at least one char from each selected category for stronger passwords
      const pools = [];
      if(lower.checked) pools.push(LOWER);
      if(upper.checked) pools.push(UPPER);
      if(numbers.checked) pools.push(NUMS);
      if(specials.checked) pools.push(SPECS);

      const out = [];

      // If requested length less than number of pools, fill from combined set
      if(len >= pools.length){
        // add one guaranteed char from each selected pool
        pools.forEach(p => {
          const idx = secureRandomInt(p.length);
          out.push(p[idx]);
        });
        // fill rest
        for(let i=out.length; i<len; i++){
          const idx = secureRandomInt(charset.length);
          out.push(charset[idx]);
        }
      } else {
        // length smaller than pools: just pick from combined set
        for(let i=0;i<len;i++){
          const idx = secureRandomInt(charset.length);
          out.push(charset[idx]);
        }
      }

      // shuffle using Fisher–Yates with crypto RNG
      for(let i=out.length-1;i>0;i--){
        const j = secureRandomInt(i+1);
        [out[i], out[j]] = [out[j], out[i]];
      }

      const pw = out.join('');
      updateStats(pw, charset.length);
      return pw;
    }

    function updateStats(pw, charsetSize){
      // entropy approx: length * log2(charsetSize)
      const bits = Math.round((pw.length * Math.log2(charsetSize))||0);
      entropyEl.textContent = bits;
      // strength heuristic
      let cls='weak', txt='Weak';
      if(bits >= 80){ cls='strong'; txt='Strong'; }
      else if(bits >= 50){ cls='medium'; txt='Medium'; }
      strengthEl.className = 'strength ' + cls;
      strengthEl.textContent = txt;
    }

    generate.addEventListener('click', ()=>{
      const pw = generatePassword();
      if(pw) result.textContent = pw;
    });

    regen.addEventListener('click', ()=>{
      const pw = generatePassword();
      if(pw) result.textContent = pw;
    });

    copy.addEventListener('click', async ()=>{
      const text = result.textContent;
      if(!text || text === '—') return;
      try{
        await navigator.clipboard.writeText(text);
        copy.textContent = 'Copied!';
        setTimeout(()=> copy.textContent = 'Copy', 1200);
      }catch(e){
        alert('Tidak dapat menyalin automaticamente. Silakan salin manual.');
      }
    });

    copyAll.addEventListener('click', async ()=>{
      const text = result.textContent;
      if(!text || text === '—') return;
      try{
        await navigator.clipboard.writeText(text);
        copyAll.textContent = 'Copied';
        setTimeout(()=> copyAll.textContent = 'Copy', 1200);
      }catch(e){
        alert('Tidak dapat menyalin automaticamente. Silakan salin manual.');
      }
    });

    // generate initial
    document.addEventListener('DOMContentLoaded', ()=>{
      const pw = generatePassword();
      if(pw) result.textContent = pw;
    });
  </script>
</body>
</html>
